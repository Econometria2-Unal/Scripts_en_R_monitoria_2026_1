library(pacman)
pacman::p_load(
plm,        # Para usar modelos con Data Panel
gplots,     # Para usar herramientas de graficación
stargazer,  # Para generar tablas comparativas en los modelos
haven,      # Para importar datos
sandwich,   # Para estimar errores robustos
lmtest,     # Para realizar inferencia estadística
tseries,    # Para manipular series de tiempo
woolridge,  # Para usar los datasets del libro de Woolridge
tidyverse,  # Paquete que incluye ggplot2 y dplyr
car         # Para verificar normalidad con gráficos de distribución cuantil.
)
# Base de datos:
Education=read_dta("http://fmwww.bc.edu/ec-p/data/wooldridge/wagepan.dta")
# Manera de visualizar toda la base de datos desde R
View(Education)
# Manera compacta de ver una base de datos
glimpse(Education)
# Tratar la base de datos como un panel de datos
panel.Education = pdata.frame(Education, index = c("nr","year"))
#Para conocer las dimensiones del panel
pdim(panel.Education)
#Para determinar si las variables cambian a lo largo del tiempo
pvar(panel.Education)
#Distribución de la población.
plotmeans(lwage ~ married, main="Distribución de la población",
data=panel.Education)
#Definición de las variables
exper2 = expersq
panel.Education$yr = factor(panel.Education$year)# Una Dummy para cada
# Mínimos cuadrados combinados.
pooled = plm(lwage~educ+black+hisp+exper+exper2+married+union+yr,
data=panel.Education, model="pooling")
#Definición de las variables
exper2 = expersq
#Definición de las variables
exper2 = education$expersq
#Definición de las variables
exper2 = panel.Education$expersq
panel.Education$yr = factor(panel.Education$year)# Una Dummy para cada
# Mínimos cuadrados combinados.
pooled = plm(lwage~educ+black+hisp+exper+exper2+married+union+yr,
data=panel.Education, model="pooling")
summary(pooled)
# Modelo de efectos aleatorios.
random = plm(lwage~educ+black+hisp+exper+exper2+married+union+yr,
data=panel.Education , model="random")
summary(random)
# Modelo de primeras diferencias.
FD = plm(lwage~exper2+married+union+yr,
data=panel.Education, model="fd")
summary(FD)
# Modelo de efectos fijos.
fixed = plm(lwage~exper2+married+union+yr,
data=panel.Education, model="within")
summary(fixed)
#Presentación de resultados.
stargazer(pooled,random,fixed,FD, type="text",
column.labels=c("OLS","RE","FE", "PD", "BT"),keep.stat=c("n","rsq"))
phtest(fixed, random) # Ho: Los modelos son equivalentes estadisticamente,
pwfdtest(lwage~exper2+married+union+yr,
data=panel.Education,h0= "fe") # H0 = corr(Uit,Uit-1) = 0
pwfdtest(lwage~exper2+married+union+yr,
data=panel.Education,h0= "fd") # H0 = errores diferenciados
plmtest(pooled,type = "bp")  # Ho: Mejor Pooled porque var(ai) = 0
# Prueba Breush-Pagan (Ho: Homocedasticidaad)
bptest(pooled)
plmtest(Pooled,"time","bp")        # Ho:Efectos temporales no significativos
plmtest(pooled,"time","bp")        # Ho:Efectos temporales no significativos
plmtest(pooled,"individual","bp")  # Ho:Efectos indivuduales no significativos
plmtest(pooled,"twoways","bp")     # Ho:Efectos temporales e individuales
# Prueba de heterocedasticidad: Usamos bptest()
bptest(Pooled);bptest(Random);bptest(Fixed); bptest(FD)
# Prueba de heterocedasticidad: Usamos bptest()
bptest(pooled);bptest(random);bptest(fixed); bptest(FD)
# Test Breusch-Godfrey para autocorrelación de orden p
bgtest(pooled);bgtest(random);bgtest(fixed);bgtest(FD)
# Breusch-Pagan LM test for cross-sectional dependence in panels
pcdtest(pooled,test = "lm")
pcdtest(random,test = "lm")
pcdtest(fixed,test = "lm")
pcdtest(FD,test = "lm")
# Correción de correlación serial para EF.
# MCOV=vcovHC.plm(Fixed, method=c("arellano"))
MCOV1=vcovHC(Fixed, method="arellano")
# Coeftest(Fixed,MCOV)
coeftest(Fixed,MCOV1)
# Correción de correlación serial para EF.
# MCOV=vcovHC.plm(Fixed, method=c("arellano"))
MCOV1=vcovHC(fixed, method="arellano")
# Coeftest(Fixed,MCOV)
coeftest(fixed,MCOV1)
help("vcovHC.plm")
#Análisis de Normalidad.
hist(residuals(fixed))
qqnorm(residuals(fixed))
qqline(residuals(fixed))
Residuales=residuals(fixed)
qqPlot(Residuales)
jarque.bera.test(residuals(Fixed))
jarque.bera.test(residuals(fixed))
